
<!DOCTYPE html><html lang="zh-CN">

<head>
  <meta charset="utf-8">
  <meta name="hexo-theme" content="https://github.com/xaoxuu/hexo-theme-stellar/tree/1.29.1" theme-name="Stellar" theme-version="1.29.1">
  
  <meta name="generator" content="Hexo 6.3.0">
  <meta http-equiv='x-dns-prefetch-control' content='on' />
  
  <meta name="renderer" content="webkit">
  <meta name="force-rendering" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="HandheldFriendly" content="True" >
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#000">
  <meta name="theme-color" content="#f9fafb">
  
  <title>HTB-Responder - FlowsecNagi's Home</title>

  
    <meta name="description" content="ResponderIntroductionWindows is the most predominant operating system in todayâ€™s world because of its easy-to-use GUI accessibility. About 85% of the market share has become a critical OS to attack. F">
<meta property="og:type" content="article">
<meta property="og:title" content="HTB-Responder">
<meta property="og:url" content="http://example.com/2023/07/12/HTB-Responder/index.html">
<meta property="og:site_name" content="FlowsecNagi&#39;s Home">
<meta property="og:description" content="ResponderIntroductionWindows is the most predominant operating system in todayâ€™s world because of its easy-to-use GUI accessibility. About 85% of the market share has become a critical OS to attack. F">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2023-07-11T16:08:37.000Z">
<meta property="article:modified_time" content="2023-07-12T12:43:10.379Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="ç¬”è®°">
<meta property="article:tag" content="HTB">
<meta property="article:tag" content="STARTING POINT">
<meta name="twitter:card" content="summary">
  
  
  
  <meta name="keywords" content="ç¬”è®°,HTB,STARTING POINT">

  <!-- feed -->
  

  <link rel="stylesheet" href="/css/main.css?v=1.29.1">

  

  
    
<link rel="stylesheet" href="https://gcore.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/styles/atom-one-dark.min.css">

  

  
</head>
<body>

<div class="l_body s:aa content tech" id="start" layout="post" ><aside class="l_left"><div class="leftbar-container">


<header class="header"><div class="logo-wrap"><a class="avatar" href="/about/"><div class="bg" style="opacity:0;background-image:url(https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/avatar/round/rainbow64@3x.webp);"></div><img no-lazy class="avatar" src="undefined" onerror="javascript:this.classList.add('error');this.src='https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/image/2659360.svg';"></a><a class="title" href="/"><div class="main" ff="title">FlowsecNagi's Home</div></a></div></header>

<div class="nav-area">
<div class="search-wrapper" id="search-wrapper"><form class="search-form"><a class="search-button" onclick="document.getElementById(&quot;search-input&quot;).focus();"><svg t="1705074644177" viewBox="0 0 1025 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1560" width="200" height="200"><path d="M1008.839137 935.96571L792.364903 719.491476a56.783488 56.783488 0 0 0-80.152866 0 358.53545 358.53545 0 1 1 100.857314-335.166073 362.840335 362.840335 0 0 1-3.689902 170.145468 51.248635 51.248635 0 1 0 99.217358 26.444296 462.057693 462.057693 0 1 0-158.255785 242.303546l185.930047 185.725053a51.248635 51.248635 0 0 0 72.568068 0 51.248635 51.248635 0 0 0 0-72.978056z" p-id="1561"></path><path d="M616.479587 615.969233a50.428657 50.428657 0 0 0-61.498362-5.534852 174.655348 174.655348 0 0 1-177.525271 3.484907 49.403684 49.403684 0 0 0-58.833433 6.76482l-3.074918 2.869923a49.403684 49.403684 0 0 0 8.609771 78.10292 277.767601 277.767601 0 0 0 286.992355-5.739847 49.403684 49.403684 0 0 0 8.404776-76.667958z" p-id="1562"></path></svg></a><input type="text" class="search-input" id="search-input" placeholder="ç«™å†…æœç´¢"></form><div id="search-result"></div><div class="search-no-result">æ²¡æœ‰æ‰¾åˆ°å†…å®¹ï¼</div></div>


<nav class="menu dis-select"></nav>
</div>
<div class="widgets">


<widget class="widget-wrapper post-list"><div class="widget-header dis-select"><span class="name">æœ€è¿‘æ›´æ–°</span></div><div class="widget-body fs14"><a class="item title" href="/2024/01/19/%E3%80%8A%E5%A4%A7%E8%84%91%E9%A9%AD%E6%89%8B%E3%80%8B%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/"><span class="title">ã€Šå¤§è„‘é©­æ‰‹ã€‹é˜…è¯»ç¬”è®°</span></a><a class="item title" href="/2024/01/22/%E7%8E%84%E5%AD%A6%E7%AC%94%E8%AE%B0/"><span class="title">ç„å­¦ç¬”è®°</span></a><a class="item title" href="/2024/07/10/CI-CD/"><span class="title">CI/CD</span></a><a class="item title" href="/2024/06/29/%E6%B8%B8%E6%88%8F%E7%AC%94%E8%AE%B0-%E6%B7%B1%E5%9C%B3I-O/"><span class="title">æ¸¸æˆ-æ·±åœ³I/O</span></a><a class="item title" href="/2024/06/30/game-greyhack/"><span class="title">game-greyhack</span></a><a class="item title" href="/2024/01/04/TPCP10-4%E7%B2%BE%E7%A5%9E%E5%88%86%E6%9E%90%E7%96%97%E6%B3%95/"><span class="title">TPCP10-note4&6</span></a><a class="item title" href="/2024/01/24/python-%E3%80%8A%E7%A8%8B%E5%BA%8F%E5%91%98%E6%95%B0%E5%AD%A6%E3%80%8B%E7%AC%94%E8%AE%B0/"><span class="title">python-ã€Šç¨‹åºå‘˜æ•°å­¦ã€‹ç¬”è®°</span></a><a class="item title" href="/2024/06/06/%E8%8B%B1%E8%AF%AD%E5%8E%9F%E8%91%97%E8%AE%A1%E5%88%92%E4%B8%8E%E7%94%9F%E8%AF%8D/"><span class="title">è‹±è¯­åŸè‘—è®¡åˆ’ä¸ç”Ÿè¯</span></a><a class="item title" href="/2023/07/07/%E5%85%B3%E4%BA%8E%E6%88%91%E5%8F%91%E5%B0%8F%E6%89%93%E7%AE%97%E7%BB%93%E6%98%8F%E8%BF%99%E4%BB%B6%E4%BA%8B%E5%B8%A6%E7%BB%99%E6%88%91%E4%BA%86%E4%BB%80%E4%B9%88/"><span class="title">å…³äºæˆ‘å‘å°çš„è¿™ä»¶äº‹å¸¦ç»™æˆ‘äº†ä»€ä¹ˆ</span></a><a class="item title" href="/2024/02/03/%E5%BE%B7%E8%AF%AD%E8%87%AA%E5%AD%A6/"><span class="title">å¾·è¯­è‡ªå­¦</span></a></div></widget>
</div>

</div></aside><div class="l_main" id="main">





<div class="article banner top">
  <div class="content">
    <div class="top bread-nav footnote"><div class="left"><div class="flex-row" id="breadcrumb"><a class="cap breadcrumb" href="/">ä¸»é¡µ</a>
<span class="sep"></span><a class="cap breadcrumb" href="/">æ–‡ç« </a><span class="sep"></span><a class="cap breadcrumb-link" href="/categories/%E5%AD%A6%E4%B9%A0/">å­¦ä¹ </a></div>
<div class="flex-row" id="post-meta"><span class="text created">å‘å¸ƒäºï¼š<time datetime="2023-07-11T16:08:37.000Z">2023-07-12</time></span><span class="sep updated"></span><span class="text updated">æ›´æ–°äºï¼š<time datetime="2023-07-12T12:43:10.379Z">2023-07-12</time></span></div></div></div>
    
    <div class="bottom only-title">
      
      <div class="text-area">
        <h1 class="text title"><span>HTB-Responder</span></h1>
        
      </div>
    </div>
    
  </div>
  </div><article class="md-text content"><h1 id="Responder"><a href="#Responder" class="headerlink" title="Responder"></a>Responder</h1><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>Windows is the most predominant operating system in todayâ€™s world because of its easy-to-use GUI accessibility. About 85% of the market share has become a critical OS to attack. Furthermore, most organizations use Active Directory to set up their Windows domain networks. Microsoft employs NTLM (New Technology LAN Manager) &amp; Kerberos for authentication services. Despite known vulnerabilities, NTLM remains widely deployed even on new systems to maintain compatibility with legacy clients and servers.<br>This lab focuses on how a File Inclusion vulnerability on a webpage being served on a windows machine can be exploited to collect the NetNTLMv2 challenge of the user that is running the web server. We will use a utility called Responder to capture a NetNTLMv2 hash and later use a utility known as john the ripper to test millions of potential passwords to see if they match the one used to create the hash. We will also be taking a deeper look at the working process of NTLM authentication and how the Responder utility captures the challenge. We believe that itâ€™s crucial to understand the under the hood workings of a tool or a framework as it strengthens the foundation of oneâ€™s understanding, which aids in the real world exploit scenarios that one might face, which do not appear to be vulnerable at the first look. Letâ€™s dive straight into it.</p>
<hr>
<p>Windowsæ˜¯å½“ä»Šä¸–ç•Œä¸Šæœ€ä¸»è¦çš„æ“ä½œç³»ç»Ÿï¼Œå› ä¸ºå®ƒæ˜“äºä½¿ç”¨çš„GUIå¯è®¿é—®æ€§ã€‚å¤§çº¦85%çš„å¸‚åœºä»½é¢å·²ç»æˆä¸ºæ”»å‡»çš„å…³é”®æ“ä½œç³»ç»Ÿã€‚æ­¤å¤–ï¼Œå¤§å¤šæ•°ç»„ç»‡éƒ½ä½¿ç”¨Active Directoryæ¥è®¾ç½®å…¶WindowsåŸŸç½‘ç»œã€‚Microsoftä½¿ç”¨NTLMï¼ˆæ–°æŠ€æœ¯å±€åŸŸç½‘ç®¡ç†å™¨ï¼‰å’ŒKerberosè¿›è¡Œèº«ä»½éªŒè¯æœåŠ¡ã€‚å°½ç®¡å­˜åœ¨å·²çŸ¥çš„æ¼æ´ï¼ŒNTLMä»ç„¶è¢«å¹¿æ³›éƒ¨ç½²åœ¨æ–°ç³»ç»Ÿä¸Šï¼Œä»¥ä¿æŒä¸æ—§å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨çš„å…¼å®¹æ€§ã€‚<br>æœ¬å®éªŒå®¤çš„é‡ç‚¹æ˜¯å¦‚ä½•åˆ©ç”¨windowsè®¡ç®—æœºä¸Šæä¾›çš„ç½‘é¡µä¸Šçš„æ–‡ä»¶åŒ…å«æ¼æ´æ¥æ”¶é›†è¿è¡ŒwebæœåŠ¡å™¨çš„ç”¨æˆ·çš„NetNTLMv2æŒ‘æˆ˜ã€‚æˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ªåä¸ºResponderçš„å®ç”¨ç¨‹åºæ¥æ•è·NetNTLMv2å“ˆå¸Œï¼Œç„¶åä½¿ç”¨ä¸€ä¸ªç§°ä¸ºjohn the ripperçš„å®ç”¨ç¨‹åºæµ‹è¯•æ•°ç™¾ä¸‡ä¸ªæ½œåœ¨å¯†ç ï¼Œçœ‹çœ‹å®ƒä»¬æ˜¯å¦ä¸ç”¨äºåˆ›å»ºå“ˆå¸Œçš„å¯†ç åŒ¹é…ã€‚æˆ‘ä»¬è¿˜å°†æ·±å…¥äº†è§£NTLMèº«ä»½éªŒè¯çš„å·¥ä½œè¿‡ç¨‹ï¼Œä»¥åŠå“åº”ç¨‹åºå®ç”¨ç¨‹åºå¦‚ä½•åº”å¯¹è¿™ä¸€æŒ‘æˆ˜ã€‚æˆ‘ä»¬è®¤ä¸ºï¼Œç†è§£ä¸€ä¸ªå·¥å…·æˆ–æ¡†æ¶çš„å¹•åå·¥ä½œè‡³å…³é‡è¦ï¼Œå› ä¸ºå®ƒåŠ å¼ºäº†äººä»¬ç†è§£çš„åŸºç¡€ï¼Œæœ‰åŠ©äºåœ¨ç°å®ä¸–ç•Œä¸­åˆ©ç”¨äººä»¬å¯èƒ½é¢ä¸´çš„åœºæ™¯ï¼Œè€Œè¿™äº›åœºæ™¯ä¹ä¸€çœ‹å¹¶ä¸è„†å¼±ã€‚è®©æˆ‘ä»¬ç›´æ¥åˆ‡å…¥ã€‚</p>
<h2 id="Enumeration"><a href="#Enumeration" class="headerlink" title="Enumeration"></a>Enumeration</h2><p>We will begin by scanning the host for any open ports and running services with a Nmap scan. We will be using the following flags for the scan:</p>
<aside>
ğŸ“ p- : This flag scans for all TCP ports ranging from 0-65535
-sV : Attempts to determine the version of the service running on a port
--min-rate : This is used to specify the minimum number of packets Nmap should send per
second; it speeds up the scan as the number goes higher


</aside>

<blockquote>
<p>Nmapå¦‚ä½•ç¡®å®šç«¯å£ä¸Šè¿è¡Œçš„æœåŠ¡ï¼Ÿ<br>Nmapä½¿ç”¨çŸ¥åæœåŠ¡çš„ç«¯å£æœåŠ¡æ•°æ®åº“æ¥ç¡®å®šåœ¨ç‰¹å®šç«¯å£ä¸Šè¿è¡Œçš„æœåŠ¡ã€‚å®ƒç¨åè¿˜ä¼šå‘è¯¥ç«¯å£å‘é€ä¸€äº›ç‰¹å®šäºæœåŠ¡çš„è¯·æ±‚ï¼Œä»¥ç¡®å®šæœåŠ¡ç‰ˆæœ¬å’Œä»»ä½•æœ‰å…³å®ƒçš„é™„åŠ ä¿¡æ¯ã€‚<br>å› æ­¤ï¼Œå¯¹äºç‰¹å®šç«¯å£çš„æœåŠ¡ä¿¡æ¯ï¼ŒNmapå¤§å¤šæ˜¯ä½†å¹¶ä¸æ€»æ˜¯æ­£ç¡®çš„ã€‚</p>
</blockquote>
<p>According to the results of the Nmap scan, the machine is using Windows as its operating system. Two ports were detected as open having Apache web server running on port 80 along with WinRM on port 5985 .</p>
<p>æ ¹æ®Nmapæ‰«æçš„ç»“æœï¼Œè¯¥æœºå™¨æ­£åœ¨ä½¿ç”¨Windowsä½œä¸ºå…¶æ“ä½œç³»ç»Ÿã€‚æ£€æµ‹åˆ°ä¸¤ä¸ªç«¯å£æ‰“å¼€ï¼ŒApache webæœåŠ¡å™¨åœ¨ç«¯å£80ä¸Šè¿è¡Œï¼ŒWinRMåœ¨ç«¯å£5985ä¸Šè¿è¡Œã€‚</p>
<aside>
â“ Windows Remote Management, or WinRM, is a Windows-native built-in remote management protocol that basically uses Simple Object Access Protocol to interact with remote computers and servers, as well as Operating Systems and applications. WinRM allows the user to :
â†’ Remotely communicate and interface with hosts
â†’ Execute commands remotely on systems that are not local to you but are network accessible.
â†’ Monitor, manage and configure servers, operating systems and client machines from a remote location.
As a pentester, this means that if we can find credentials (typically username and password) for a user who has remote management privileges, we can potentially get a PowerShell shell on the host.


</aside>

<aside>
â“ Windowsè¿œç¨‹ç®¡ç†ï¼ˆWinRMï¼‰æ˜¯ä¸€ç§Windowsæœ¬æœºå†…ç½®è¿œç¨‹ç®¡ç†åè®®ï¼ŒåŸºæœ¬ä¸Šä½¿ç”¨ç®€å•å¯¹è±¡è®¿é—®åè®®ä¸è¿œç¨‹è®¡ç®—æœºå’ŒæœåŠ¡å™¨ä»¥åŠæ“ä½œç³»ç»Ÿå’Œåº”ç”¨ç¨‹åºè¿›è¡Œäº¤äº’ã€‚WinRMå…è®¸ç”¨æˆ·ï¼š
â†’ ä¸ä¸»æœºè¿œç¨‹é€šä¿¡å’Œæ¥å£
â†’ åœ¨éæœ¬åœ°ä½†å¯é€šè¿‡ç½‘ç»œè®¿é—®çš„ç³»ç»Ÿä¸Šè¿œç¨‹æ‰§è¡Œå‘½ä»¤ã€‚
â†’ ä»è¿œç¨‹ä½ç½®ç›‘è§†ã€ç®¡ç†å’Œé…ç½®æœåŠ¡å™¨ã€æ“ä½œç³»ç»Ÿå’Œå®¢æˆ·ç«¯æœºå™¨ã€‚
ä½œä¸ºpentesterï¼Œè¿™æ„å‘³ç€å¦‚æœæˆ‘ä»¬èƒ½æ‰¾åˆ°å…·æœ‰è¿œç¨‹ç®¡ç†æƒé™çš„ç”¨æˆ·çš„å‡­æ®ï¼ˆé€šå¸¸æ˜¯ç”¨æˆ·åå’Œå¯†ç ï¼‰ï¼Œæˆ‘ä»¬å°±æœ‰å¯èƒ½åœ¨ä¸»æœºä¸Šè·å¾—PowerShell shellã€‚


</aside>

<h2 id="Website-Enumeration"><a href="#Website-Enumeration" class="headerlink" title="Website Enumeration"></a>Website Enumeration</h2><p>On opening Firefox and putting http:&#x2F;&#x2F;[target ip] , the browser returns a message about being unable to find that site. Looking in the URL bar, it now shows <a target="_blank" rel="noopener" href="http://unika.htb/">http://unika.htb</a> . The website has redirected the browser to a new URL, and your host doesnâ€™t know how to find unika.htb . This webserver is employing name-based Virtual Hosting for serving the requests.</p>
<p>æ‰“å¼€Firefoxå¹¶æ”¾å…¥http:&#x2F;&#x2F;[target-ip]åï¼Œæµè§ˆå™¨ä¼šè¿”å›ä¸€æ¡æ— æ³•æ‰¾åˆ°è¯¥ç½‘ç«™çš„æ¶ˆæ¯ã€‚åœ¨URLæ ä¸­æŸ¥çœ‹ï¼Œå®ƒç°åœ¨æ˜¾ç¤º<a target="_blank" rel="noopener" href="http://unika.htb.è¯¥ç½‘ç«™å·²å°†æµè§ˆå™¨é‡å®šå‘åˆ°ä¸€ä¸ªæ–°çš„url,è€Œæ‚¨çš„ä¸»æœºä¸çŸ¥é“å¦‚ä½•æ‰¾åˆ°unika.htb.è¯¥webæœåŠ¡å™¨ä½¿ç”¨åŸºäºåç§°çš„è™šæ‹Ÿä¸»æœºæ¥æ»¡è¶³è¯·æ±‚./">http://unika.htbã€‚è¯¥ç½‘ç«™å·²å°†æµè§ˆå™¨é‡å®šå‘åˆ°ä¸€ä¸ªæ–°çš„URLï¼Œè€Œæ‚¨çš„ä¸»æœºä¸çŸ¥é“å¦‚ä½•æ‰¾åˆ°unika.htbã€‚è¯¥WebæœåŠ¡å™¨ä½¿ç”¨åŸºäºåç§°çš„è™šæ‹Ÿä¸»æœºæ¥æ»¡è¶³è¯·æ±‚ã€‚</a></p>
<p>Name-Based Virtual hosting is a method for hosting multiple domain names (with separate handling ofeach name) on a single server. This allows one server to share its resources, such as memory and processor cycles, without requiring all the services to be used by the same hostname.<br>The web server checks the domain name provided in the Host header field of the HTTP request and sends a response according to that.</p>
<p>åŸºäºåç§°çš„è™šæ‹Ÿæ‰˜ç®¡æ˜¯ä¸€ç§åœ¨å•ä¸ªæœåŠ¡å™¨ä¸Šæ‰˜ç®¡å¤šä¸ªåŸŸåï¼ˆæ¯ä¸ªåç§°å•ç‹¬å¤„ç†ï¼‰çš„æ–¹æ³•ã€‚è¿™å…è®¸ä¸€å°æœåŠ¡å™¨å…±äº«å…¶èµ„æºï¼Œä¾‹å¦‚å†…å­˜å’Œå¤„ç†å™¨å‘¨æœŸï¼Œè€Œä¸éœ€è¦åŒä¸€ä¸»æœºåä½¿ç”¨æ‰€æœ‰æœåŠ¡ã€‚<br>webæœåŠ¡å™¨æ£€æŸ¥HTTPè¯·æ±‚çš„ä¸»æœºå¤´å­—æ®µä¸­æä¾›çš„åŸŸåï¼Œå¹¶æ ¹æ®è¯¥åŸŸåå‘é€å“åº”ã€‚<br>The &#x2F;etc&#x2F;hosts file is used to resolve a hostname into an IP address &amp; thus we will need to add an entry in the &#x2F;etc&#x2F;hosts file for this domain to enable the browser to resolve the address for unika.htb .</p>
<p>&#x2F;etc&#x2F;hostsæ–‡ä»¶ç”¨äºå°†ä¸»æœºåè§£æä¸ºIPåœ°å€&amp;å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦åœ¨è¯¥åŸŸçš„&#x2F;etc&#x2F;hostæ–‡ä»¶ä¸­æ·»åŠ ä¸€ä¸ªæ¡ç›®ï¼Œä»¥ä½¿æµè§ˆå™¨èƒ½å¤Ÿè§£æunika.htbçš„åœ°å€ã€‚</p>
<p>Entry in the &#x2F;etc&#x2F;hosts file :</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;10.129.136.91 unika.htb&quot;</span> | <span class="hljs-built_in">sudo</span> <span class="hljs-built_in">tee</span> -a /etc/hosts<br></code></pre></td></tr></table></figure>

<p>Adding this entry in the &#x2F;etc&#x2F;hosts file will enable the browser to resolve the hostname unika.htb to<br>the corresponding IP address &amp; thus make the browser include the HTTP header Host: unika.htb in<br>every HTTP request that the browser sends to this IP address, which will make the server respond with the webpage for unika.htb .</p>
<p>åœ¨&#x2F;etc&#x2F;hostsæ–‡ä»¶ä¸­æ·»åŠ æ­¤æ¡ç›®å°†ä½¿æµè§ˆå™¨èƒ½å¤Ÿå°†ä¸»æœºåunika.htbè§£æä¸ºç›¸åº”çš„IPåœ°å€ï¼Œä»è€Œä½¿æµè§ˆå™¨åœ¨å‘è¯¥IPåœ°å€å‘é€çš„æ¯ä¸ªHTTPè¯·æ±‚ä¸­éƒ½åŒ…å«HTTPæ ‡å¤´Host:unika.htbï¼Œè¿™å°†ä½¿æœåŠ¡å™¨ä»¥unika.hç»“æ ¸çš„ç½‘é¡µè¿›è¡Œå“åº”ã€‚<br>On accessing the web page we are presented with a web designing business landing page.</p>
<p>åœ¨è®¿é—®ç½‘é¡µæ—¶ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°ä¸€ä¸ªç½‘é¡µè®¾è®¡ä¸šåŠ¡ç™»å½•é¡µã€‚</p>
<p>Checking the site out, we see nothing of particular interest. Although, we notice a language selection option on the navbar EN and changing the option to FR takes us to a French version of the website.</p>
<p>æŸ¥çœ‹ç½‘ç«™ï¼Œæˆ‘ä»¬æ²¡æœ‰å‘ç°ä»»ä½•ç‰¹åˆ«æ„Ÿå…´è¶£çš„ä¸œè¥¿ã€‚å°½ç®¡å¦‚æ­¤ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°å¯¼èˆªæ ENä¸Šæœ‰ä¸€ä¸ªè¯­è¨€é€‰æ‹©é€‰é¡¹ï¼Œå°†è¯¥é€‰é¡¹æ›´æ”¹ä¸ºFRä¼šå°†æˆ‘ä»¬å¸¦åˆ°è¯¥ç½‘ç«™çš„æ³•è¯­ç‰ˆæœ¬ã€‚</p>
<p>Noticing the URL, we can see that the french.html page is being loaded by the page parameter, which may potentially be vulnerable to a Local File Inclusion (LFI) vulnerability if the page input is not sanitized.</p>
<p>æ³¨æ„åˆ°URLï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°french.htmlé¡µé¢æ˜¯ç”±é¡µé¢å‚æ•°åŠ è½½çš„ï¼Œå¦‚æœé¡µé¢è¾“å…¥æ²¡æœ‰è¢«æ¸…é™¤ï¼Œå®ƒå¯èƒ½ä¼šå—åˆ°æœ¬åœ°æ–‡ä»¶åŒ…å«ï¼ˆLFIï¼‰æ¼æ´çš„æ”»å‡»ã€‚</p>
<h2 id="File-Inclusion-Vulnerability"><a href="#File-Inclusion-Vulnerability" class="headerlink" title="File Inclusion Vulnerability"></a>File Inclusion Vulnerability</h2><p>Dynamic websites include HTML pages on the fly using information from the HTTP request to include GET and POST parameters, cookies, and other variables. It is common for a page to â€œincludeâ€ another page based on some of these parameters.</p>
<p>åŠ¨æ€ç½‘ç«™åŒ…æ‹¬åŠ¨æ€HTMLé¡µé¢ï¼Œä½¿ç”¨HTTPè¯·æ±‚ä¸­çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬GETå’ŒPOSTå‚æ•°ã€cookieå’Œå…¶ä»–å˜é‡ã€‚ä¸€ä¸ªé¡µé¢é€šå¸¸ä¼šæ ¹æ®å…¶ä¸­ä¸€äº›å‚æ•°â€œåŒ…å«â€å¦ä¸€ä¸ªé¡µé¢ã€‚</p>
<aside>
ğŸ’¡ LFI or Local File Inclusion occurs when an attacker is able to get a website to include a file that was not intended to be an option for this application. A common example is when an application uses the path to a file as input. If the application treats this input as trusted, and the required sanitary checks are not performed on this input, then the attacker can exploit it by using the ../ string in the inputted file name and eventually view sensitive files in the local file system. In some limited cases, an LFI can lead to code execution as well.


</aside>

<p>å½“æ”»å‡»è€…èƒ½å¤Ÿä½¿ç½‘ç«™åŒ…å«ä¸€ä¸ªä¸æ‰“ç®—ä½œä¸ºæ­¤åº”ç”¨ç¨‹åºé€‰é¡¹çš„æ–‡ä»¶æ—¶ï¼Œå°±ä¼šå‘ç”ŸLFIæˆ–æœ¬åœ°æ–‡ä»¶åŒ…å«ã€‚ä¸€ä¸ªå¸¸è§çš„ä¾‹å­æ˜¯åº”ç”¨ç¨‹åºä½¿ç”¨æ–‡ä»¶çš„è·¯å¾„ä½œä¸ºè¾“å…¥ã€‚å¦‚æœåº”ç”¨ç¨‹åºå°†æ­¤è¾“å…¥è§†ä¸ºå¯ä¿¡è¾“å…¥ï¼Œå¹¶ä¸”æœªå¯¹æ­¤è¾“å…¥æ‰§è¡Œæ‰€éœ€çš„å«ç”Ÿæ£€æŸ¥ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥ä½¿ç”¨..&#x2F;å­—ç¬¦ä¸²ï¼Œå¹¶æœ€ç»ˆæŸ¥çœ‹æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¸­çš„æ•æ„Ÿæ–‡ä»¶ã€‚åœ¨æŸäº›æœ‰é™çš„æƒ…å†µä¸‹ï¼ŒLFIä¹Ÿå¯ä»¥å¯¼è‡´ä»£ç æ‰§è¡Œã€‚</p>
<aside>
ğŸ’¡ RFI or Remote File Inclusion is similar to LFI but in this case it is possible for an attacker to load a remote file on the host using protocols like HTTP, FTP etc.


</aside>

<p>RFIæˆ–è¿œç¨‹æ–‡ä»¶åŒ…å«ç±»ä¼¼äºLFIï¼Œä½†åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ”»å‡»è€…æœ‰å¯èƒ½ä½¿ç”¨HTTPã€FTPç­‰åè®®åœ¨ä¸»æœºä¸ŠåŠ è½½è¿œç¨‹æ–‡ä»¶ã€‚</p>
<p>We test the page parameter to see if we can include files on the target system in the server response. We will test with some commonly known files that will have the same name across networks, Windows domains, and systems which can be found here. One of the most common files that a penetration tester might attempt to access on a Windows machine to verify LFI is the hosts file, WINDOWS\System32\drivers\etc\hosts (this file aids in the local translation of host names to IP<br>addresses). The ..&#x2F; string is used to traverse back a directory, one at a time. Thus multiple ..&#x2F; strings are included in the URL so that the file handler on the server traverses back to the base directory i.e. C:\ .</p>
<p>æˆ‘ä»¬æµ‹è¯•é¡µé¢å‚æ•°ï¼Œçœ‹çœ‹æ˜¯å¦å¯ä»¥åœ¨æœåŠ¡å™¨å“åº”ä¸­åŒ…æ‹¬ç›®æ ‡ç³»ç»Ÿä¸Šçš„æ–‡ä»¶ã€‚æˆ‘ä»¬å°†ä½¿ç”¨ä¸€äº›å¸¸è§çš„æ–‡ä»¶è¿›è¡Œæµ‹è¯•ï¼Œè¿™äº›æ–‡ä»¶å°†åœ¨ç½‘ç»œã€WindowsåŸŸå’Œç³»ç»Ÿä¸­å…·æœ‰ç›¸åŒçš„åç§°ï¼Œè¿™äº›æ–‡ä»¶å¯ä»¥åœ¨æ­¤å¤„æ‰¾åˆ°ã€‚æ¸—é€æµ‹è¯•äººå‘˜å¯èƒ½è¯•å›¾åœ¨Windowsæœºå™¨ä¸Šè®¿é—®ä»¥éªŒè¯LFIçš„æœ€å¸¸è§æ–‡ä»¶ä¹‹ä¸€æ˜¯hostsæ–‡ä»¶Windows\System32\drivers\etc\hostsï¼ˆè¯¥æ–‡ä»¶æœ‰åŠ©äºå°†ä¸»æœºåæœ¬åœ°è½¬æ¢ä¸ºIPåœ°å€ï¼‰ã€‚..&#x2F;å­—ç¬¦ä¸²ç”¨äºä¸€æ¬¡éå†ä¸€ä¸ªç›®å½•ã€‚å› æ­¤å€æ•°..&#x2F;å­—ç¬¦ä¸²åŒ…å«åœ¨URLä¸­ï¼Œä»¥ä¾¿æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶å¤„ç†ç¨‹åºéå†å›åŸºæœ¬ç›®å½•ï¼Œå³C:\ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">http://unika.htb/index.php?<br>page=../../../../../../../../windows/system32/drivers/etc/hosts<br></code></pre></td></tr></table></figure>

<p>Great, LFI is possible as we can view the contents of the C:\windows\system32\drivers\etc\hosts file in the response.</p>
<p>å¾ˆå¥½ï¼ŒLFIæ˜¯å¯èƒ½çš„ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥åœ¨å“åº”ä¸­æŸ¥çœ‹C:\windows\system32\drivers\etc\hostsæ–‡ä»¶çš„å†…å®¹ã€‚<br>The file inclusion, in this case, was made possible because in the backend the include() method of PHP is being used to process the URL parameter page for serving a different webpage for different languages. And because no proper sanitization is being done on this page parameter, we were able to pass malicious input and therefore view the internal system files.<br>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¹‹æ‰€ä»¥å¯ä»¥åŒ…å«æ–‡ä»¶ï¼Œæ˜¯å› ä¸ºåœ¨åç«¯ï¼ŒPHPçš„includeï¼ˆï¼‰æ–¹æ³•è¢«ç”¨äºå¤„ç†URLå‚æ•°é¡µé¢ï¼Œä»¥ä¾¿ä¸ºä¸åŒè¯­è¨€çš„ä¸åŒç½‘é¡µæä¾›æœåŠ¡ã€‚ç”±äºæ²¡æœ‰å¯¹æ­¤é¡µé¢å‚æ•°è¿›è¡Œé€‚å½“çš„æ¸…ç†ï¼Œæˆ‘ä»¬èƒ½å¤Ÿä¼ é€’æ¶æ„è¾“å…¥ï¼Œä»è€ŒæŸ¥çœ‹å†…éƒ¨ç³»ç»Ÿæ–‡ä»¶ã€‚</p>
<p><strong>What is the include() method in PHP?</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php">File <span class="hljs-number">1</span> --&gt; vars.php<br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$color</span> = <span class="hljs-string">&#x27;green&#x27;</span>;<br><span class="hljs-variable">$fruit</span> = <span class="hljs-string">&#x27;apple&#x27;</span>;<br><span class="hljs-meta">?&gt;</span><br><span class="hljs-comment">#############################################</span><br>File <span class="hljs-number">2</span> --&gt; test.php<br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;A <span class="hljs-subst">$color</span> <span class="hljs-subst">$fruit</span>&quot;</span>; <span class="hljs-comment">// output = &quot;A&quot;</span><br><span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;vars.php&#x27;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;A <span class="hljs-subst">$color</span> <span class="hljs-subst">$fruit</span>&quot;</span>; <span class="hljs-comment">// output = &quot;A green apple&quot;</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://www.php.net/manual/en/function.include.php">https://www.php.net/manual/en/function.include.php</a></p>
<p><strong>What is NTLM (New Technology Lan Manager)?</strong></p>
<p>NTLM is a collection of authentication protocols created by Microsoft. It is a challenge-response<br>authentication protocol used to authenticate a client to a resource on an Active Directory domain.<br>It is a type of single sign-on (SSO) because it allows the user to provide the underlying authentication factor only once, at login.</p>
<p>NTLMæ˜¯ç”±Microsoftåˆ›å»ºçš„èº«ä»½éªŒè¯åè®®çš„é›†åˆã€‚å®ƒæ˜¯ä¸€ç§è´¨è¯¢-å“åº”èº«ä»½éªŒè¯åè®®ï¼Œç”¨äºå°†å®¢æˆ·ç«¯èº«ä»½éªŒè¯ä¸ºActive DirectoryåŸŸä¸Šçš„èµ„æºã€‚<br>å®ƒæ˜¯ä¸€ç§å•ç‚¹ç™»å½•ï¼ˆSSOï¼‰ï¼Œå› ä¸ºå®ƒåªå…è®¸ç”¨æˆ·åœ¨ç™»å½•æ—¶æä¾›ä¸€æ¬¡åº•å±‚èº«ä»½éªŒè¯å› ç´ ã€‚</p>
<p>The NTLM authentication process is done in the following way :</p>
<ol>
<li>The client sends the user name and domain name to the server.</li>
<li>The server generates a random character string, referred to as the challenge.</li>
<li>The client encrypts the challenge with the NTLM hash of the user password and sends it back to the server.</li>
<li>The server retrieves the user password (or equivilent).</li>
<li>The server uses the hash value retrieved from the security account database to encrypt the challenge string. The value is then compared to the value received from the client. If the values match, the client is authenticated.</li>
</ol>
<aside>
ğŸ’¡ NTLMèº«ä»½éªŒè¯è¿‡ç¨‹é€šè¿‡ä»¥ä¸‹æ–¹å¼å®Œæˆï¼š
1.å®¢æˆ·ç«¯å°†ç”¨æˆ·åå’ŒåŸŸåå‘é€ç»™æœåŠ¡å™¨ã€‚
2.æœåŠ¡å™¨ç”Ÿæˆä¸€ä¸ªéšæœºå­—ç¬¦ä¸²ï¼Œç§°ä¸ºæŒ‘æˆ˜ã€‚
3.å®¢æˆ·ç«¯ä½¿ç”¨ç”¨æˆ·å¯†ç çš„NTLMå“ˆå¸Œå¯¹è´¨è¯¢è¿›è¡ŒåŠ å¯†ï¼Œå¹¶å°†å…¶å‘é€å›æœåŠ¡å™¨ã€‚
4.æœåŠ¡å™¨æ£€ç´¢ç”¨æˆ·å¯†ç ï¼ˆæˆ–ç­‰æ•ˆå¯†ç ï¼‰ã€‚
5.æœåŠ¡å™¨ä½¿ç”¨ä»å®‰å…¨å¸æˆ·æ•°æ®åº“ä¸­æ£€ç´¢åˆ°çš„å“ˆå¸Œå€¼æ¥åŠ å¯†è´¨è¯¢å­—ç¬¦ä¸²ã€‚ç„¶åå°†è¯¥å€¼ä¸ä»å®¢æˆ·ç«¯æ¥æ”¶åˆ°çš„å€¼è¿›è¡Œæ¯”è¾ƒã€‚å¦‚æœå€¼åŒ¹é…ï¼Œåˆ™å¯¹å®¢æˆ·ç«¯è¿›è¡Œèº«ä»½éªŒè¯ã€‚


</aside>

<p>NTLMä¸NTHashä¸NetNTLMv2</p>
<p>å…³äºNTLMèº«ä»½éªŒè¯çš„æœ¯è¯­å¾ˆæ··ä¹±ï¼Œç”šè‡³ä¸“ä¸šäººå£«ä¹Ÿä¼šä¸æ—¶æ»¥ç”¨å®ƒï¼Œæ‰€ä»¥è®©æˆ‘ä»¬å®šä¹‰ä¸€äº›å…³é”®æœ¯è¯­ï¼š</p>
<ul>
<li>æ•£åˆ—å‡½æ•°æ˜¯ä¸€ç§å•å‘å‡½æ•°ï¼Œå®ƒæ¥å—ä»»æ„æ•°é‡çš„æ•°æ®å¹¶è¿”å›å›ºå®šå¤§å°çš„å€¼ã€‚<br>é€šå¸¸ï¼Œç»“æœè¢«ç§°ä¸ºæ•£åˆ—ã€æ‘˜è¦æˆ–æŒ‡çº¹ã€‚å®ƒä»¬ç”¨äºæ›´å®‰å…¨åœ°å­˜å‚¨å¯†ç ï¼Œå› ä¸ºæ— æ³•å°†å“ˆå¸Œç›´æ¥è½¬æ¢å›åŸå§‹æ•°æ®ï¼ˆå°½ç®¡ä¹Ÿæœ‰è¯•å›¾ä»å“ˆå¸Œä¸­æ¢å¤å¯†ç çš„æ”»å‡»ï¼Œæˆ‘ä»¬ç¨åä¼šçœ‹åˆ°ï¼‰ã€‚å› æ­¤ï¼ŒæœåŠ¡å™¨å¯ä»¥å­˜å‚¨æ‚¨çš„å¯†ç æ•£åˆ—ï¼Œå½“æ‚¨å°†å¯†ç æäº¤åˆ°ç½‘ç«™æ—¶ï¼Œå®ƒä¼šå¯¹æ‚¨çš„è¾“å…¥è¿›è¡Œæ•£åˆ—ï¼Œå¹¶å°†ç»“æœä¸æ•°æ®åº“ä¸­çš„æ•£åˆ—è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœå®ƒä»¬åŒ¹é…ï¼Œå®ƒå°±ä¼šçŸ¥é“æ‚¨æä¾›äº†æ­£ç¡®çš„å¯†ç ã€‚</li>
<li>NTHashæ˜¯ç”¨äºåœ¨SAMæ•°æ®åº“å’ŒåŸŸæ§åˆ¶å™¨ä¸­çš„Windowsç³»ç»Ÿä¸Šå­˜å‚¨å¯†ç çš„ç®—æ³•çš„è¾“å‡ºã€‚NTHashé€šå¸¸è¢«ç§°ä¸ºNTLMå“ˆå¸Œï¼Œç”šè‡³åªæ˜¯NTLMï¼Œè¿™éå¸¸å…·æœ‰è¯¯å¯¼æ€§&#x2F;æ··æ·†æ€§ã€‚</li>
<li>å½“NTLMåè®®æƒ³è¦é€šè¿‡ç½‘ç»œè¿›è¡Œèº«ä»½éªŒè¯æ—¶ï¼Œå®ƒä¼šä½¿ç”¨å¦‚ä¸Šæ‰€è¿°çš„è´¨è¯¢&#x2F;å“åº”æ¨¡å‹ã€‚NetNTLMv2è´¨è¯¢&#x2F;å“åº”æ˜¯ä¸€ä¸ªä¸“é—¨æ ¼å¼åŒ–ä¸ºåŒ…æ‹¬è´¨è¯¢å’Œå“åº”çš„å­—ç¬¦ä¸²ã€‚è¿™é€šå¸¸è¢«ç§°ä¸ºNetNTLMv2å“ˆå¸Œï¼Œä½†å®é™…ä¸Šå¹¶ä¸æ˜¯å“ˆå¸Œã€‚å°½ç®¡å¦‚æ­¤ï¼Œå®ƒé€šå¸¸è¢«ç§°ä¸ºå“ˆå¸Œï¼Œå› ä¸ºæˆ‘ä»¬ä»¥åŒæ ·çš„æ–¹å¼æ”»å‡»å®ƒã€‚æ‚¨å°†çœ‹åˆ°NetNTLMv2å¯¹è±¡è¢«ç§°ä¸ºNTLMv2ï¼Œç”šè‡³è¢«æ··æ·†ä¸ºNTLMã€‚</li>
</ul>
<h2 id="Using-Responder"><a href="#Using-Responder" class="headerlink" title="Using Responder"></a>Using Responder</h2>
<div class="article-footer fs14">
    <section id="license">
      <div class="header"><span>è®¸å¯åè®®</span></div>
      <div class="body"><p>æœ¬æ–‡é‡‡ç”¨ <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº« 4.0 å›½é™…</a> è®¸å¯åè®®ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>
</div>
    </section>
    </div>
</article>
<div class="related-wrap" id="read-next"><section class="body"><div class="item" id="prev"><div class="note">è¾ƒæ–°æ–‡ç« </div><a href="/2023/07/13/%E5%8E%86%E7%BB%8F%E5%8D%81%E5%B9%B4%E6%89%BE%E5%AF%BB%E6%AF%95%E7%94%9F%E7%83%AD%E7%88%B1%E4%B9%8B%E4%BA%8B/">å†ç»åå¹´æ‰¾å¯»æ¯•ç”Ÿçƒ­çˆ±ä¹‹äº‹</a></div><div class="item" id="next"><div class="note">è¾ƒæ—©æ–‡ç« </div><a href="/2023/07/11/web%E6%94%BB%E9%98%B2%E7%AC%94%E8%AE%B0%E7%AC%AC44%E5%A4%A9/">webæ”»é˜²ç¬”è®°ç¬¬44å¤©</a></div></section></div>






<footer class="page-footer footnote"><hr><div class="text"><p>æœ¬ç«™ç”± <a href="/">John Doe</a> ä½¿ç”¨ <a target="_blank" rel="noopener" href="https://github.com/xaoxuu/hexo-theme-stellar/tree/1.29.1">Stellar 1.29.1</a> ä¸»é¢˜åˆ›å»ºã€‚<br>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>
</div></footer>
<div class="main-mask" onclick="sidebar.dismiss()"></div></div><aside class="l_right">
<div class="widgets">



<widget class="widget-wrapper toc" id="data-toc" collapse="false"><div class="widget-header dis-select"><span class="name">æœ¬æ–‡ç›®å½•</span><a class="cap-action" onclick="sidebar.toggleTOC()" ><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6h11m-11 6h11m-11 6h11M4 6h1v4m-1 0h2m0 8H4c0-1 2-2 2-3s-1-1.5-2-1"/></svg></a></div><div class="widget-body"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Responder"><span class="toc-text">Responder</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Introduction"><span class="toc-text">Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Enumeration"><span class="toc-text">Enumeration</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Website-Enumeration"><span class="toc-text">Website Enumeration</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#File-Inclusion-Vulnerability"><span class="toc-text">File Inclusion Vulnerability</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Using-Responder"><span class="toc-text">Using Responder</span></a></li></ol></li></ol></div><div class="widget-footer">

<a class="top" onclick="util.scrollTop()"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="1.5"><path d="M2 12c0-4.714 0-7.071 1.464-8.536C4.93 2 7.286 2 12 2c4.714 0 7.071 0 8.535 1.464C22 4.93 22 7.286 22 12c0 4.714 0 7.071-1.465 8.535C19.072 22 16.714 22 12 22s-7.071 0-8.536-1.465C2 19.072 2 16.714 2 12Z"/><path stroke-linecap="round" stroke-linejoin="round" d="m9 15.5l3-3l3 3m-6-4l3-3l3 3"/></g></svg><span>å›åˆ°é¡¶éƒ¨</span></a></div></widget>
</div></aside><div class='float-panel blur'>
  <button type='button' style='display:none' class='laptop-only rightbar-toggle mobile' onclick='sidebar.rightbar()'>
    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6h11m-11 6h11m-11 6h11M4 6h1v4m-1 0h2m0 8H4c0-1 2-2 2-3s-1-1.5-2-1"/></svg>
  </button>
  <button type='button' style='display:none' class='mobile-only leftbar-toggle mobile' onclick='sidebar.leftbar()'>
    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="1.5"><path d="M2 11c0-3.771 0-5.657 1.172-6.828C4.343 3 6.229 3 10 3h4c3.771 0 5.657 0 6.828 1.172C22 5.343 22 7.229 22 11v2c0 3.771 0 5.657-1.172 6.828C19.657 21 17.771 21 14 21h-4c-3.771 0-5.657 0-6.828-1.172C2 18.657 2 16.771 2 13z"/><path id="sep" stroke-linecap="round" d="M5.5 10h6m-5 4h4m4.5 7V3"/></g></svg>
  </button>
</div>
</div><div class="scripts">
<script type="text/javascript">
  const ctx = {
    date_suffix: {
      just: `åˆšåˆš`,
      min: `åˆ†é’Ÿå‰`,
      hour: `å°æ—¶å‰`,
      day: `å¤©å‰`,
    },
    root : `/`,
  };

  // required plugins (only load if needs)
  if (`local_search`) {
    ctx.search = {};
    ctx.search.service = `local_search`;
    if (ctx.search.service == 'local_search') {
      let service_obj = Object.assign({}, `{"field":"all","path":"/search.json","content":true,"sort":"-date"}`);
      ctx.search[ctx.search.service] = service_obj;
    }
  }
  const def = {
    avatar: `https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/avatar/round/3442075.svg`,
    cover: `https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/cover/76b86c0226ffd.svg`,
  };
  const deps = {
    jquery: `https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js`,
    marked: `https://cdn.jsdelivr.net/npm/marked@13.0.1/lib/marked.umd.min.js`
  }
  

</script>

<script type="text/javascript">
  const utils = {
    // æ‡’åŠ è½½ css https://github.com/filamentgroup/loadCSS
    css: (href, before, media, attributes) => {
      var doc = window.document;
      var ss = doc.createElement("link");
      var ref;
      if (before) {
        ref = before;
      } else {
        var refs = (doc.body || doc.getElementsByTagName("head")[0]).childNodes;
        ref = refs[refs.length - 1];
      }
      var sheets = doc.styleSheets;
      if (attributes) {
        for (var attributeName in attributes) {
          if (attributes.hasOwnProperty(attributeName)) {
            ss.setAttribute(attributeName, attributes[attributeName]);
          }
        }
      }
      ss.rel = "stylesheet";
      ss.href = href;
      ss.media = "only x";
      function ready(cb) {
        if (doc.body) {
          return cb();
        }
        setTimeout(function () {
          ready(cb);
        });
      }
      ready(function () {
        ref.parentNode.insertBefore(ss, before ? ref : ref.nextSibling);
      });
      var onloadcssdefined = function (cb) {
        var resolvedHref = ss.href;
        var i = sheets.length;
        while (i--) {
          if (sheets[i].href === resolvedHref) {
            return cb();
          }
        }
        setTimeout(function () {
          onloadcssdefined(cb);
        });
      };
      function loadCB() {
        if (ss.addEventListener) {
          ss.removeEventListener("load", loadCB);
        }
        ss.media = media || "all";
      }
      if (ss.addEventListener) {
        ss.addEventListener("load", loadCB);
      }
      ss.onloadcssdefined = onloadcssdefined;
      onloadcssdefined(loadCB);
      return ss;
    },

    js: (src, opt) => new Promise((resolve, reject) => {
      var script = document.createElement('script');
      if (src.startsWith('/')){
        src = ctx.root + src.substring(1);
      }
      script.src = src;
      if (opt) {
        for (let key of Object.keys(opt)) {
          script[key] = opt[key]
        }
      } else {
        // é»˜è®¤å¼‚æ­¥ï¼Œå¦‚æœéœ€è¦åŒæ­¥ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¼ å…¥ {} å³å¯
        script.async = true
      }
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    }),

    jq: (fn) => {
      if (typeof jQuery === 'undefined') {
        utils.js(deps.jquery).then(fn)
      } else {
        fn()
      }
    },
    
    onLoading: (el) => {
      if (el) {
        $(el).append('<div class="loading-wrap"><svg xmlns="http://www.w3.org/2000/svg" width="2em" height="2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="2"><path stroke-dasharray="60" stroke-dashoffset="60" stroke-opacity=".3" d="M12 3C16.9706 3 21 7.02944 21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3Z"><animate fill="freeze" attributeName="stroke-dashoffset" dur="1.3s" values="60;0"/></path><path stroke-dasharray="15" stroke-dashoffset="15" d="M12 3C16.9706 3 21 7.02944 21 12"><animate fill="freeze" attributeName="stroke-dashoffset" dur="0.3s" values="15;0"/><animateTransform attributeName="transform" dur="1.5s" repeatCount="indefinite" type="rotate" values="0 12 12;360 12 12"/></path></g></svg></div>');
      }
    },
    onLoadSuccess: (el) => {
      if (el) {
        $(el).find('.loading-wrap').remove();
      }
    },
    onLoadFailure: (el) => {
      if (el) {
        $(el).find('.loading-wrap svg').remove();
        $(el).find('.loading-wrap').append('<svg xmlns="http://www.w3.org/2000/svg" width="2em" height="2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path stroke-dasharray="60" stroke-dashoffset="60" d="M12 3L21 20H3L12 3Z"><animate fill="freeze" attributeName="stroke-dashoffset" dur="0.5s" values="60;0"/></path><path stroke-dasharray="6" stroke-dashoffset="6" d="M12 10V14"><animate fill="freeze" attributeName="stroke-dashoffset" begin="0.6s" dur="0.2s" values="6;0"/></path></g><circle cx="12" cy="17" r="1" fill="currentColor" fill-opacity="0"><animate fill="freeze" attributeName="fill-opacity" begin="0.8s" dur="0.4s" values="0;1"/></circle></svg>');
        $(el).find('.loading-wrap').addClass('error');
      }
    },
    request: (el, url, callback, onFailure) => {
      let retryTimes = 3;
      utils.onLoading(el);
      function req() {
        return new Promise((resolve, reject) => {
          let status = 0; // 0 ç­‰å¾… 1 å®Œæˆ 2 è¶…æ—¶
          let timer = setTimeout(() => {
            if (status === 0) {
              status = 2;
              timer = null;
              reject('è¯·æ±‚è¶…æ—¶');
              if (retryTimes == 0) {
                onFailure();
              }
            }
          }, 5000);
          fetch(url).then(function(response) {
            if (status !== 2) {
              clearTimeout(timer);
              resolve(response);
              timer = null;
              status = 1;
            }
            if (response.ok) {
              return response.json();
            }
            throw new Error('Network response was not ok.');
          }).then(function(data) {
            retryTimes = 0;
            utils.onLoadSuccess(el);
            callback(data);
          }).catch(function(error) {
            if (retryTimes > 0) {
              retryTimes -= 1;
              setTimeout(() => {
                req();
              }, 5000);
            } else {
              utils.onLoadFailure(el);
              onFailure();
            }
          });
        });
      }
      req();
    },
  };
</script>

<script>
  const sidebar = {
    leftbar: () => {
      if (l_body) {
        l_body.toggleAttribute('leftbar');
        l_body.removeAttribute('rightbar');
      }
    },
    rightbar: () => {
      if (l_body) {
        l_body.toggleAttribute('rightbar');
        l_body.removeAttribute('leftbar');
      }
    },
    dismiss: () => {
      if (l_body) {
        l_body.removeAttribute('leftbar');
        l_body.removeAttribute('rightbar');
      }
    },
    toggleTOC: () => {
      document.querySelector('#data-toc').classList.toggle('collapse');
    }
  }
</script>
<script type="text/javascript">
  (() => {
    const tagSwitchers = document.querySelectorAll('.tag-subtree.parent-tag > a > .tag-switcher-wrapper')
    for (const tagSwitcher of tagSwitchers) {
      tagSwitcher.addEventListener('click', (e) => {
        const parent = e.target.closest('.tag-subtree.parent-tag')
        parent.classList.toggle('expanded')
        e.preventDefault()
      })
    }

    // Get active tag from query string, then activate it.
    const urlParams = new URLSearchParams(window.location.search)
    const activeTag = urlParams.get('tag')
    if (activeTag) {
      let tag = document.querySelector(`.tag-subtree[data-tag="${activeTag}"]`)
      if (tag) {
        tag.querySelector('a').classList.add('active')
        
        while (tag) {
          tag.classList.add('expanded')
          tag = tag.parentElement.closest('.tag-subtree.parent-tag')
        }
      }
    }
  })()
</script>


<!-- required -->
<script src="/js/main.js?v=1.29.1" defer></script>

<script type="text/javascript">
  const applyTheme = (theme) => {
    if (theme === 'auto') {
      document.documentElement.removeAttribute('data-theme')
    } else {
      document.documentElement.setAttribute('data-theme', theme)
    }

    applyThemeToGiscus(theme)
  }

  const applyThemeToGiscus = (theme) => {
    theme = theme === 'auto' ? 'preferred_color_scheme' : theme

    const cmt = document.getElementById('giscus')
    if (cmt) {
      // This works before giscus load.
      cmt.setAttribute('data-theme', theme)
    }

    const iframe = document.querySelector('#comments > section.giscus > iframe')
    if (iframe) {
      // This works after giscus loaded.
      const src = iframe.src
      const newSrc = src.replace(/theme=[\w]+/, `theme=${theme}`)
      iframe.src = newSrc
    }
  }

  const switchTheme = () => {
    // light -> dark -> auto -> light -> ...
    const currentTheme = document.documentElement.getAttribute('data-theme')
    let newTheme;
    switch (currentTheme) {
      case 'light':
        newTheme = 'dark'
        break
      case 'dark':
        newTheme = 'auto'
        break
      default:
        newTheme = 'light'
    }
    applyTheme(newTheme)
    window.localStorage.setItem('Stellar.theme', newTheme)

    const messages = {
      light: `åˆ‡æ¢åˆ°æµ…è‰²æ¨¡å¼`,
      dark: `åˆ‡æ¢åˆ°æ·±è‰²æ¨¡å¼`,
      auto: `åˆ‡æ¢åˆ°è·Ÿéšç³»ç»Ÿé…è‰²`,
    }
    hud?.toast?.(messages[newTheme])
  }

  (() => {
    // Apply user's preferred theme, if any.
    const theme = window.localStorage.getItem('Stellar.theme')
    if (theme !== null) {
      applyTheme(theme)
    }
  })()
</script>


<!-- optional -->



<script defer>
  window.addEventListener('DOMContentLoaded', (event) => {
    ctx.services = Object.assign({}, JSON.parse(`{"mdrender":{"js":"/js/services/mdrender.js"},"siteinfo":{"js":"/js/services/siteinfo.js","api":null},"ghinfo":{"js":"/js/services/ghinfo.js"},"sites":{"js":"/js/services/sites.js"},"friends":{"js":"/js/services/friends.js"},"timeline":{"js":"/js/services/timeline.js"},"fcircle":{"js":"/js/services/fcircle.js"},"weibo":{"js":"/js/services/weibo.js"},"memos":{"js":"/js/services/memos.js"}}`));
    for (let id of Object.keys(ctx.services)) {
      const js = ctx.services[id].js;
      if (id == 'siteinfo') {
        ctx.cardlinks = document.querySelectorAll('a.link-card[cardlink]');
        if (ctx.cardlinks?.length > 0) {
          utils.js(js, { defer: true }).then(function () {
            setCardLink(ctx.cardlinks);
          });
        }
      } else {
        const els = document.getElementsByClassName(`ds-${id}`);
        if (els?.length > 0) {
          utils.jq(() => {
            if (id == 'timeline' || 'memos' || 'marked') {
              utils.js(deps.marked).then(function () {
                utils.js(js, { defer: true });
              });
            } else {
              utils.js(js, { defer: true });
            }
          });
        }
      }
    }
  });
</script>

<script>
  window.addEventListener('DOMContentLoaded', (event) => {
    ctx.search = {
      path: `/search.json`,
    }
    utils.js('/js/search/local-search.js', { defer: true });
  });
</script><script>
  window.FPConfig = {
    delay: 0,
    ignoreKeywords: [],
    maxRPS: 5,
    hoverDelay: 25
  };
</script>
<script defer src="https://cdn.jsdelivr.net/npm/flying-pages@2/flying-pages.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@19.1.3/dist/lazyload.min.js"></script>
<script>
  // https://www.npmjs.com/package/vanilla-lazyload
  // Set the options globally
  // to make LazyLoad self-initialize
  window.lazyLoadOptions = {
    elements_selector: ".lazy",
  };
  // Listen to the initialization event
  // and get the instance of LazyLoad
  window.addEventListener(
    "LazyLoad::Initialized",
    function (event) {
      window.lazyLoadInstance = event.detail.instance;
    },
    false
  );
  document.addEventListener('DOMContentLoaded', function () {
    window.lazyLoadInstance?.update();
  });
</script><script>
  ctx.fancybox = {
    selector: `.timenode p>img`,
    css: `https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0/dist/fancybox/fancybox.css`,
    js: `https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0/dist/fancybox/fancybox.umd.js`
  };
  var selector = '[data-fancybox]:not(.error)';
  if (ctx.fancybox.selector) {
    selector += `, ${ctx.fancybox.selector}`
  }
  var needFancybox = document.querySelectorAll(selector).length !== 0;
  if (!needFancybox) {
    const els = document.getElementsByClassName('ds-memos');
    if (els != undefined && els.length > 0) {
      needFancybox = true;
    }
  }
  if (needFancybox) {
    utils.css(ctx.fancybox.css);
    utils.js(ctx.fancybox.js, { defer: true }).then(function () {
      Fancybox.bind(selector, {
        hideScrollbar: false,
        Thumbs: {
          autoStart: false,
        },
        caption: (fancybox, slide) => {
          return slide.triggerEl.alt || slide.triggerEl.dataset.caption || null
        }
      });
    })
  }
</script>
<script>
  window.addEventListener('DOMContentLoaded', (event) => {
    const swiper_api = document.getElementById('swiper-api');
    if (swiper_api != undefined) {
      utils.css(`https://unpkg.com/swiper@10.3.1/swiper-bundle.min.css`);
      utils.js(`https://unpkg.com/swiper@10.3.1/swiper-bundle.min.js`, { defer: true }).then(function () {
        const effect = swiper_api.getAttribute('effect') || '';
        var swiper = new Swiper('.swiper#swiper-api', {
          slidesPerView: 'auto',
          spaceBetween: 8,
          centeredSlides: true,
          effect: effect,
          rewind: true,
          pagination: {
            el: '.swiper-pagination',
            clickable: true,
          },
          navigation: {
            nextEl: '.swiper-button-next',
            prevEl: '.swiper-button-prev',
          },
        });
      })
    }
  });
</script>
<script>
  document.addEventListener('DOMContentLoaded', function () {
    window.codeElements = document.querySelectorAll('.code');
    if (window.codeElements.length > 0) {
      ctx.copycode = {
        default_text: `Copy`,
        success_text: `Copied`,
        toast: `å¤åˆ¶æˆåŠŸ`,
      };
      utils.js('/js/plugins/copycode.js');
    }
  });
</script>


<!-- inject -->

</div></body></html>
