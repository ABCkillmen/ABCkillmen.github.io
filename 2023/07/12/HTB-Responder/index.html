
<!DOCTYPE html><html lang="zh-CN">

<head>
  <meta charset="utf-8">
  <meta name="hexo-theme" content="https://github.com/xaoxuu/hexo-theme-stellar/tree/1.29.1" theme-name="Stellar" theme-version="1.29.1">
  
  <meta name="generator" content="Hexo 6.3.0">
  <meta http-equiv='x-dns-prefetch-control' content='on' />
  
  <meta name="renderer" content="webkit">
  <meta name="force-rendering" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="HandheldFriendly" content="True" >
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#000">
  <meta name="theme-color" content="#f9fafb">
  
  <title>HTB-Responder - FlowsecNagi's Home</title>

  
    <meta name="description" content="ResponderIntroductionWindows is the most predominant operating system in today’s world because of its easy-to-use GUI accessibility. About 85% of the market share has become a critical OS to attack. F">
<meta property="og:type" content="article">
<meta property="og:title" content="HTB-Responder">
<meta property="og:url" content="http://example.com/2023/07/12/HTB-Responder/index.html">
<meta property="og:site_name" content="FlowsecNagi&#39;s Home">
<meta property="og:description" content="ResponderIntroductionWindows is the most predominant operating system in today’s world because of its easy-to-use GUI accessibility. About 85% of the market share has become a critical OS to attack. F">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2023-07-11T16:08:37.000Z">
<meta property="article:modified_time" content="2023-07-12T12:43:10.379Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="笔记">
<meta property="article:tag" content="HTB">
<meta property="article:tag" content="STARTING POINT">
<meta name="twitter:card" content="summary">
  
  
  
  <meta name="keywords" content="笔记,HTB,STARTING POINT">

  <!-- feed -->
  

  <link rel="stylesheet" href="/css/main.css?v=1.29.1">

  

  
    
<link rel="stylesheet" href="https://gcore.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/styles/atom-one-dark.min.css">

  

  
</head>
<body>

<div class="l_body s:aa content tech" id="start" layout="post" ><aside class="l_left"><div class="leftbar-container">


<header class="header"><div class="logo-wrap"><a class="avatar" href="/about/"><div class="bg" style="opacity:0;background-image:url(https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/avatar/round/rainbow64@3x.webp);"></div><img no-lazy class="avatar" src="undefined" onerror="javascript:this.classList.add('error');this.src='https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/image/2659360.svg';"></a><a class="title" href="/"><div class="main" ff="title">FlowsecNagi's Home</div></a></div></header>

<div class="nav-area">
<div class="search-wrapper" id="search-wrapper"><form class="search-form"><a class="search-button" onclick="document.getElementById(&quot;search-input&quot;).focus();"><svg t="1705074644177" viewBox="0 0 1025 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1560" width="200" height="200"><path d="M1008.839137 935.96571L792.364903 719.491476a56.783488 56.783488 0 0 0-80.152866 0 358.53545 358.53545 0 1 1 100.857314-335.166073 362.840335 362.840335 0 0 1-3.689902 170.145468 51.248635 51.248635 0 1 0 99.217358 26.444296 462.057693 462.057693 0 1 0-158.255785 242.303546l185.930047 185.725053a51.248635 51.248635 0 0 0 72.568068 0 51.248635 51.248635 0 0 0 0-72.978056z" p-id="1561"></path><path d="M616.479587 615.969233a50.428657 50.428657 0 0 0-61.498362-5.534852 174.655348 174.655348 0 0 1-177.525271 3.484907 49.403684 49.403684 0 0 0-58.833433 6.76482l-3.074918 2.869923a49.403684 49.403684 0 0 0 8.609771 78.10292 277.767601 277.767601 0 0 0 286.992355-5.739847 49.403684 49.403684 0 0 0 8.404776-76.667958z" p-id="1562"></path></svg></a><input type="text" class="search-input" id="search-input" placeholder="站内搜索"></form><div id="search-result"></div><div class="search-no-result">没有找到内容！</div></div>


<nav class="menu dis-select"></nav>
</div>
<div class="widgets">


<widget class="widget-wrapper post-list"><div class="widget-header dis-select"><span class="name">最近更新</span></div><div class="widget-body fs14"><a class="item title" href="/2024/01/19/%E3%80%8A%E5%A4%A7%E8%84%91%E9%A9%AD%E6%89%8B%E3%80%8B%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/"><span class="title">《大脑驭手》阅读笔记</span></a><a class="item title" href="/2024/01/22/%E7%8E%84%E5%AD%A6%E7%AC%94%E8%AE%B0/"><span class="title">玄学笔记</span></a><a class="item title" href="/2024/07/10/CI-CD/"><span class="title">CI/CD</span></a><a class="item title" href="/2024/06/29/%E6%B8%B8%E6%88%8F%E7%AC%94%E8%AE%B0-%E6%B7%B1%E5%9C%B3I-O/"><span class="title">游戏-深圳I/O</span></a><a class="item title" href="/2024/06/30/game-greyhack/"><span class="title">game-greyhack</span></a><a class="item title" href="/2024/01/04/TPCP10-4%E7%B2%BE%E7%A5%9E%E5%88%86%E6%9E%90%E7%96%97%E6%B3%95/"><span class="title">TPCP10-note4&6</span></a><a class="item title" href="/2024/01/24/python-%E3%80%8A%E7%A8%8B%E5%BA%8F%E5%91%98%E6%95%B0%E5%AD%A6%E3%80%8B%E7%AC%94%E8%AE%B0/"><span class="title">python-《程序员数学》笔记</span></a><a class="item title" href="/2024/06/06/%E8%8B%B1%E8%AF%AD%E5%8E%9F%E8%91%97%E8%AE%A1%E5%88%92%E4%B8%8E%E7%94%9F%E8%AF%8D/"><span class="title">英语原著计划与生词</span></a><a class="item title" href="/2023/07/07/%E5%85%B3%E4%BA%8E%E6%88%91%E5%8F%91%E5%B0%8F%E6%89%93%E7%AE%97%E7%BB%93%E6%98%8F%E8%BF%99%E4%BB%B6%E4%BA%8B%E5%B8%A6%E7%BB%99%E6%88%91%E4%BA%86%E4%BB%80%E4%B9%88/"><span class="title">关于我发小的这件事带给我了什么</span></a><a class="item title" href="/2024/02/03/%E5%BE%B7%E8%AF%AD%E8%87%AA%E5%AD%A6/"><span class="title">德语自学</span></a></div></widget>
</div>

</div></aside><div class="l_main" id="main">





<div class="article banner top">
  <div class="content">
    <div class="top bread-nav footnote"><div class="left"><div class="flex-row" id="breadcrumb"><a class="cap breadcrumb" href="/">主页</a>
<span class="sep"></span><a class="cap breadcrumb" href="/">文章</a><span class="sep"></span><a class="cap breadcrumb-link" href="/categories/%E5%AD%A6%E4%B9%A0/">学习</a></div>
<div class="flex-row" id="post-meta"><span class="text created">发布于：<time datetime="2023-07-11T16:08:37.000Z">2023-07-12</time></span><span class="sep updated"></span><span class="text updated">更新于：<time datetime="2023-07-12T12:43:10.379Z">2023-07-12</time></span></div></div></div>
    
    <div class="bottom only-title">
      
      <div class="text-area">
        <h1 class="text title"><span>HTB-Responder</span></h1>
        
      </div>
    </div>
    
  </div>
  </div><article class="md-text content"><h1 id="Responder"><a href="#Responder" class="headerlink" title="Responder"></a>Responder</h1><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>Windows is the most predominant operating system in today’s world because of its easy-to-use GUI accessibility. About 85% of the market share has become a critical OS to attack. Furthermore, most organizations use Active Directory to set up their Windows domain networks. Microsoft employs NTLM (New Technology LAN Manager) &amp; Kerberos for authentication services. Despite known vulnerabilities, NTLM remains widely deployed even on new systems to maintain compatibility with legacy clients and servers.<br>This lab focuses on how a File Inclusion vulnerability on a webpage being served on a windows machine can be exploited to collect the NetNTLMv2 challenge of the user that is running the web server. We will use a utility called Responder to capture a NetNTLMv2 hash and later use a utility known as john the ripper to test millions of potential passwords to see if they match the one used to create the hash. We will also be taking a deeper look at the working process of NTLM authentication and how the Responder utility captures the challenge. We believe that it’s crucial to understand the under the hood workings of a tool or a framework as it strengthens the foundation of one’s understanding, which aids in the real world exploit scenarios that one might face, which do not appear to be vulnerable at the first look. Let’s dive straight into it.</p>
<hr>
<p>Windows是当今世界上最主要的操作系统，因为它易于使用的GUI可访问性。大约85%的市场份额已经成为攻击的关键操作系统。此外，大多数组织都使用Active Directory来设置其Windows域网络。Microsoft使用NTLM（新技术局域网管理器）和Kerberos进行身份验证服务。尽管存在已知的漏洞，NTLM仍然被广泛部署在新系统上，以保持与旧客户端和服务器的兼容性。<br>本实验室的重点是如何利用windows计算机上提供的网页上的文件包含漏洞来收集运行web服务器的用户的NetNTLMv2挑战。我们将使用一个名为Responder的实用程序来捕获NetNTLMv2哈希，然后使用一个称为john the ripper的实用程序测试数百万个潜在密码，看看它们是否与用于创建哈希的密码匹配。我们还将深入了解NTLM身份验证的工作过程，以及响应程序实用程序如何应对这一挑战。我们认为，理解一个工具或框架的幕后工作至关重要，因为它加强了人们理解的基础，有助于在现实世界中利用人们可能面临的场景，而这些场景乍一看并不脆弱。让我们直接切入。</p>
<h2 id="Enumeration"><a href="#Enumeration" class="headerlink" title="Enumeration"></a>Enumeration</h2><p>We will begin by scanning the host for any open ports and running services with a Nmap scan. We will be using the following flags for the scan:</p>
<aside>
📎 p- : This flag scans for all TCP ports ranging from 0-65535
-sV : Attempts to determine the version of the service running on a port
--min-rate : This is used to specify the minimum number of packets Nmap should send per
second; it speeds up the scan as the number goes higher


</aside>

<blockquote>
<p>Nmap如何确定端口上运行的服务？<br>Nmap使用知名服务的端口服务数据库来确定在特定端口上运行的服务。它稍后还会向该端口发送一些特定于服务的请求，以确定服务版本和任何有关它的附加信息。<br>因此，对于特定端口的服务信息，Nmap大多是但并不总是正确的。</p>
</blockquote>
<p>According to the results of the Nmap scan, the machine is using Windows as its operating system. Two ports were detected as open having Apache web server running on port 80 along with WinRM on port 5985 .</p>
<p>根据Nmap扫描的结果，该机器正在使用Windows作为其操作系统。检测到两个端口打开，Apache web服务器在端口80上运行，WinRM在端口5985上运行。</p>
<aside>
❓ Windows Remote Management, or WinRM, is a Windows-native built-in remote management protocol that basically uses Simple Object Access Protocol to interact with remote computers and servers, as well as Operating Systems and applications. WinRM allows the user to :
→ Remotely communicate and interface with hosts
→ Execute commands remotely on systems that are not local to you but are network accessible.
→ Monitor, manage and configure servers, operating systems and client machines from a remote location.
As a pentester, this means that if we can find credentials (typically username and password) for a user who has remote management privileges, we can potentially get a PowerShell shell on the host.


</aside>

<aside>
❓ Windows远程管理（WinRM）是一种Windows本机内置远程管理协议，基本上使用简单对象访问协议与远程计算机和服务器以及操作系统和应用程序进行交互。WinRM允许用户：
→ 与主机远程通信和接口
→ 在非本地但可通过网络访问的系统上远程执行命令。
→ 从远程位置监视、管理和配置服务器、操作系统和客户端机器。
作为pentester，这意味着如果我们能找到具有远程管理权限的用户的凭据（通常是用户名和密码），我们就有可能在主机上获得PowerShell shell。


</aside>

<h2 id="Website-Enumeration"><a href="#Website-Enumeration" class="headerlink" title="Website Enumeration"></a>Website Enumeration</h2><p>On opening Firefox and putting http:&#x2F;&#x2F;[target ip] , the browser returns a message about being unable to find that site. Looking in the URL bar, it now shows <a target="_blank" rel="noopener" href="http://unika.htb/">http://unika.htb</a> . The website has redirected the browser to a new URL, and your host doesn’t know how to find unika.htb . This webserver is employing name-based Virtual Hosting for serving the requests.</p>
<p>打开Firefox并放入http:&#x2F;&#x2F;[target-ip]后，浏览器会返回一条无法找到该网站的消息。在URL栏中查看，它现在显示<a target="_blank" rel="noopener" href="http://unika.htb.该网站已将浏览器重定向到一个新的url,而您的主机不知道如何找到unika.htb.该web服务器使用基于名称的虚拟主机来满足请求./">http://unika.htb。该网站已将浏览器重定向到一个新的URL，而您的主机不知道如何找到unika.htb。该Web服务器使用基于名称的虚拟主机来满足请求。</a></p>
<p>Name-Based Virtual hosting is a method for hosting multiple domain names (with separate handling ofeach name) on a single server. This allows one server to share its resources, such as memory and processor cycles, without requiring all the services to be used by the same hostname.<br>The web server checks the domain name provided in the Host header field of the HTTP request and sends a response according to that.</p>
<p>基于名称的虚拟托管是一种在单个服务器上托管多个域名（每个名称单独处理）的方法。这允许一台服务器共享其资源，例如内存和处理器周期，而不需要同一主机名使用所有服务。<br>web服务器检查HTTP请求的主机头字段中提供的域名，并根据该域名发送响应。<br>The &#x2F;etc&#x2F;hosts file is used to resolve a hostname into an IP address &amp; thus we will need to add an entry in the &#x2F;etc&#x2F;hosts file for this domain to enable the browser to resolve the address for unika.htb .</p>
<p>&#x2F;etc&#x2F;hosts文件用于将主机名解析为IP地址&amp;因此，我们需要在该域的&#x2F;etc&#x2F;host文件中添加一个条目，以使浏览器能够解析unika.htb的地址。</p>
<p>Entry in the &#x2F;etc&#x2F;hosts file :</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;10.129.136.91 unika.htb&quot;</span> | <span class="hljs-built_in">sudo</span> <span class="hljs-built_in">tee</span> -a /etc/hosts<br></code></pre></td></tr></table></figure>

<p>Adding this entry in the &#x2F;etc&#x2F;hosts file will enable the browser to resolve the hostname unika.htb to<br>the corresponding IP address &amp; thus make the browser include the HTTP header Host: unika.htb in<br>every HTTP request that the browser sends to this IP address, which will make the server respond with the webpage for unika.htb .</p>
<p>在&#x2F;etc&#x2F;hosts文件中添加此条目将使浏览器能够将主机名unika.htb解析为相应的IP地址，从而使浏览器在向该IP地址发送的每个HTTP请求中都包含HTTP标头Host:unika.htb，这将使服务器以unika.h结核的网页进行响应。<br>On accessing the web page we are presented with a web designing business landing page.</p>
<p>在访问网页时，我们会看到一个网页设计业务登录页。</p>
<p>Checking the site out, we see nothing of particular interest. Although, we notice a language selection option on the navbar EN and changing the option to FR takes us to a French version of the website.</p>
<p>查看网站，我们没有发现任何特别感兴趣的东西。尽管如此，我们注意到导航栏EN上有一个语言选择选项，将该选项更改为FR会将我们带到该网站的法语版本。</p>
<p>Noticing the URL, we can see that the french.html page is being loaded by the page parameter, which may potentially be vulnerable to a Local File Inclusion (LFI) vulnerability if the page input is not sanitized.</p>
<p>注意到URL，我们可以看到french.html页面是由页面参数加载的，如果页面输入没有被清除，它可能会受到本地文件包含（LFI）漏洞的攻击。</p>
<h2 id="File-Inclusion-Vulnerability"><a href="#File-Inclusion-Vulnerability" class="headerlink" title="File Inclusion Vulnerability"></a>File Inclusion Vulnerability</h2><p>Dynamic websites include HTML pages on the fly using information from the HTTP request to include GET and POST parameters, cookies, and other variables. It is common for a page to “include” another page based on some of these parameters.</p>
<p>动态网站包括动态HTML页面，使用HTTP请求中的信息，包括GET和POST参数、cookie和其他变量。一个页面通常会根据其中一些参数“包含”另一个页面。</p>
<aside>
💡 LFI or Local File Inclusion occurs when an attacker is able to get a website to include a file that was not intended to be an option for this application. A common example is when an application uses the path to a file as input. If the application treats this input as trusted, and the required sanitary checks are not performed on this input, then the attacker can exploit it by using the ../ string in the inputted file name and eventually view sensitive files in the local file system. In some limited cases, an LFI can lead to code execution as well.


</aside>

<p>当攻击者能够使网站包含一个不打算作为此应用程序选项的文件时，就会发生LFI或本地文件包含。一个常见的例子是应用程序使用文件的路径作为输入。如果应用程序将此输入视为可信输入，并且未对此输入执行所需的卫生检查，则攻击者可以使用..&#x2F;字符串，并最终查看本地文件系统中的敏感文件。在某些有限的情况下，LFI也可以导致代码执行。</p>
<aside>
💡 RFI or Remote File Inclusion is similar to LFI but in this case it is possible for an attacker to load a remote file on the host using protocols like HTTP, FTP etc.


</aside>

<p>RFI或远程文件包含类似于LFI，但在这种情况下，攻击者有可能使用HTTP、FTP等协议在主机上加载远程文件。</p>
<p>We test the page parameter to see if we can include files on the target system in the server response. We will test with some commonly known files that will have the same name across networks, Windows domains, and systems which can be found here. One of the most common files that a penetration tester might attempt to access on a Windows machine to verify LFI is the hosts file, WINDOWS\System32\drivers\etc\hosts (this file aids in the local translation of host names to IP<br>addresses). The ..&#x2F; string is used to traverse back a directory, one at a time. Thus multiple ..&#x2F; strings are included in the URL so that the file handler on the server traverses back to the base directory i.e. C:\ .</p>
<p>我们测试页面参数，看看是否可以在服务器响应中包括目标系统上的文件。我们将使用一些常见的文件进行测试，这些文件将在网络、Windows域和系统中具有相同的名称，这些文件可以在此处找到。渗透测试人员可能试图在Windows机器上访问以验证LFI的最常见文件之一是hosts文件Windows\System32\drivers\etc\hosts（该文件有助于将主机名本地转换为IP地址）。..&#x2F;字符串用于一次遍历一个目录。因此倍数..&#x2F;字符串包含在URL中，以便服务器上的文件处理程序遍历回基本目录，即C:\。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">http://unika.htb/index.php?<br>page=../../../../../../../../windows/system32/drivers/etc/hosts<br></code></pre></td></tr></table></figure>

<p>Great, LFI is possible as we can view the contents of the C:\windows\system32\drivers\etc\hosts file in the response.</p>
<p>很好，LFI是可能的，因为我们可以在响应中查看C:\windows\system32\drivers\etc\hosts文件的内容。<br>The file inclusion, in this case, was made possible because in the backend the include() method of PHP is being used to process the URL parameter page for serving a different webpage for different languages. And because no proper sanitization is being done on this page parameter, we were able to pass malicious input and therefore view the internal system files.<br>在这种情况下，之所以可以包含文件，是因为在后端，PHP的include（）方法被用于处理URL参数页面，以便为不同语言的不同网页提供服务。由于没有对此页面参数进行适当的清理，我们能够传递恶意输入，从而查看内部系统文件。</p>
<p><strong>What is the include() method in PHP?</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php">File <span class="hljs-number">1</span> --&gt; vars.php<br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$color</span> = <span class="hljs-string">&#x27;green&#x27;</span>;<br><span class="hljs-variable">$fruit</span> = <span class="hljs-string">&#x27;apple&#x27;</span>;<br><span class="hljs-meta">?&gt;</span><br><span class="hljs-comment">#############################################</span><br>File <span class="hljs-number">2</span> --&gt; test.php<br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;A <span class="hljs-subst">$color</span> <span class="hljs-subst">$fruit</span>&quot;</span>; <span class="hljs-comment">// output = &quot;A&quot;</span><br><span class="hljs-keyword">include</span> <span class="hljs-string">&#x27;vars.php&#x27;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;A <span class="hljs-subst">$color</span> <span class="hljs-subst">$fruit</span>&quot;</span>; <span class="hljs-comment">// output = &quot;A green apple&quot;</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://www.php.net/manual/en/function.include.php">https://www.php.net/manual/en/function.include.php</a></p>
<p><strong>What is NTLM (New Technology Lan Manager)?</strong></p>
<p>NTLM is a collection of authentication protocols created by Microsoft. It is a challenge-response<br>authentication protocol used to authenticate a client to a resource on an Active Directory domain.<br>It is a type of single sign-on (SSO) because it allows the user to provide the underlying authentication factor only once, at login.</p>
<p>NTLM是由Microsoft创建的身份验证协议的集合。它是一种质询-响应身份验证协议，用于将客户端身份验证为Active Directory域上的资源。<br>它是一种单点登录（SSO），因为它只允许用户在登录时提供一次底层身份验证因素。</p>
<p>The NTLM authentication process is done in the following way :</p>
<ol>
<li>The client sends the user name and domain name to the server.</li>
<li>The server generates a random character string, referred to as the challenge.</li>
<li>The client encrypts the challenge with the NTLM hash of the user password and sends it back to the server.</li>
<li>The server retrieves the user password (or equivilent).</li>
<li>The server uses the hash value retrieved from the security account database to encrypt the challenge string. The value is then compared to the value received from the client. If the values match, the client is authenticated.</li>
</ol>
<aside>
💡 NTLM身份验证过程通过以下方式完成：
1.客户端将用户名和域名发送给服务器。
2.服务器生成一个随机字符串，称为挑战。
3.客户端使用用户密码的NTLM哈希对质询进行加密，并将其发送回服务器。
4.服务器检索用户密码（或等效密码）。
5.服务器使用从安全帐户数据库中检索到的哈希值来加密质询字符串。然后将该值与从客户端接收到的值进行比较。如果值匹配，则对客户端进行身份验证。


</aside>

<p>NTLM与NTHash与NetNTLMv2</p>
<p>关于NTLM身份验证的术语很混乱，甚至专业人士也会不时滥用它，所以让我们定义一些关键术语：</p>
<ul>
<li>散列函数是一种单向函数，它接受任意数量的数据并返回固定大小的值。<br>通常，结果被称为散列、摘要或指纹。它们用于更安全地存储密码，因为无法将哈希直接转换回原始数据（尽管也有试图从哈希中恢复密码的攻击，我们稍后会看到）。因此，服务器可以存储您的密码散列，当您将密码提交到网站时，它会对您的输入进行散列，并将结果与数据库中的散列进行比较，如果它们匹配，它就会知道您提供了正确的密码。</li>
<li>NTHash是用于在SAM数据库和域控制器中的Windows系统上存储密码的算法的输出。NTHash通常被称为NTLM哈希，甚至只是NTLM，这非常具有误导性&#x2F;混淆性。</li>
<li>当NTLM协议想要通过网络进行身份验证时，它会使用如上所述的质询&#x2F;响应模型。NetNTLMv2质询&#x2F;响应是一个专门格式化为包括质询和响应的字符串。这通常被称为NetNTLMv2哈希，但实际上并不是哈希。尽管如此，它通常被称为哈希，因为我们以同样的方式攻击它。您将看到NetNTLMv2对象被称为NTLMv2，甚至被混淆为NTLM。</li>
</ul>
<h2 id="Using-Responder"><a href="#Using-Responder" class="headerlink" title="Using Responder"></a>Using Responder</h2>
<div class="article-footer fs14">
    <section id="license">
      <div class="header"><span>许可协议</span></div>
      <div class="body"><p>本文采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">署名-非商业性使用-相同方式共享 4.0 国际</a> 许可协议，转载请注明出处。</p>
</div>
    </section>
    </div>
</article>
<div class="related-wrap" id="read-next"><section class="body"><div class="item" id="prev"><div class="note">较新文章</div><a href="/2023/07/13/%E5%8E%86%E7%BB%8F%E5%8D%81%E5%B9%B4%E6%89%BE%E5%AF%BB%E6%AF%95%E7%94%9F%E7%83%AD%E7%88%B1%E4%B9%8B%E4%BA%8B/">历经十年找寻毕生热爱之事</a></div><div class="item" id="next"><div class="note">较早文章</div><a href="/2023/07/11/web%E6%94%BB%E9%98%B2%E7%AC%94%E8%AE%B0%E7%AC%AC44%E5%A4%A9/">web攻防笔记第44天</a></div></section></div>






<footer class="page-footer footnote"><hr><div class="text"><p>本站由 <a href="/">John Doe</a> 使用 <a target="_blank" rel="noopener" href="https://github.com/xaoxuu/hexo-theme-stellar/tree/1.29.1">Stellar 1.29.1</a> 主题创建。<br>本博客所有文章除特别声明外，均采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议，转载请注明出处。</p>
</div></footer>
<div class="main-mask" onclick="sidebar.dismiss()"></div></div><aside class="l_right">
<div class="widgets">



<widget class="widget-wrapper toc" id="data-toc" collapse="false"><div class="widget-header dis-select"><span class="name">本文目录</span><a class="cap-action" onclick="sidebar.toggleTOC()" ><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6h11m-11 6h11m-11 6h11M4 6h1v4m-1 0h2m0 8H4c0-1 2-2 2-3s-1-1.5-2-1"/></svg></a></div><div class="widget-body"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Responder"><span class="toc-text">Responder</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Introduction"><span class="toc-text">Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Enumeration"><span class="toc-text">Enumeration</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Website-Enumeration"><span class="toc-text">Website Enumeration</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#File-Inclusion-Vulnerability"><span class="toc-text">File Inclusion Vulnerability</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Using-Responder"><span class="toc-text">Using Responder</span></a></li></ol></li></ol></div><div class="widget-footer">

<a class="top" onclick="util.scrollTop()"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="1.5"><path d="M2 12c0-4.714 0-7.071 1.464-8.536C4.93 2 7.286 2 12 2c4.714 0 7.071 0 8.535 1.464C22 4.93 22 7.286 22 12c0 4.714 0 7.071-1.465 8.535C19.072 22 16.714 22 12 22s-7.071 0-8.536-1.465C2 19.072 2 16.714 2 12Z"/><path stroke-linecap="round" stroke-linejoin="round" d="m9 15.5l3-3l3 3m-6-4l3-3l3 3"/></g></svg><span>回到顶部</span></a></div></widget>
</div></aside><div class='float-panel blur'>
  <button type='button' style='display:none' class='laptop-only rightbar-toggle mobile' onclick='sidebar.rightbar()'>
    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6h11m-11 6h11m-11 6h11M4 6h1v4m-1 0h2m0 8H4c0-1 2-2 2-3s-1-1.5-2-1"/></svg>
  </button>
  <button type='button' style='display:none' class='mobile-only leftbar-toggle mobile' onclick='sidebar.leftbar()'>
    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="1.5"><path d="M2 11c0-3.771 0-5.657 1.172-6.828C4.343 3 6.229 3 10 3h4c3.771 0 5.657 0 6.828 1.172C22 5.343 22 7.229 22 11v2c0 3.771 0 5.657-1.172 6.828C19.657 21 17.771 21 14 21h-4c-3.771 0-5.657 0-6.828-1.172C2 18.657 2 16.771 2 13z"/><path id="sep" stroke-linecap="round" d="M5.5 10h6m-5 4h4m4.5 7V3"/></g></svg>
  </button>
</div>
</div><div class="scripts">
<script type="text/javascript">
  const ctx = {
    date_suffix: {
      just: `刚刚`,
      min: `分钟前`,
      hour: `小时前`,
      day: `天前`,
    },
    root : `/`,
  };

  // required plugins (only load if needs)
  if (`local_search`) {
    ctx.search = {};
    ctx.search.service = `local_search`;
    if (ctx.search.service == 'local_search') {
      let service_obj = Object.assign({}, `{"field":"all","path":"/search.json","content":true,"sort":"-date"}`);
      ctx.search[ctx.search.service] = service_obj;
    }
  }
  const def = {
    avatar: `https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/avatar/round/3442075.svg`,
    cover: `https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/cover/76b86c0226ffd.svg`,
  };
  const deps = {
    jquery: `https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js`,
    marked: `https://cdn.jsdelivr.net/npm/marked@13.0.1/lib/marked.umd.min.js`
  }
  

</script>

<script type="text/javascript">
  const utils = {
    // 懒加载 css https://github.com/filamentgroup/loadCSS
    css: (href, before, media, attributes) => {
      var doc = window.document;
      var ss = doc.createElement("link");
      var ref;
      if (before) {
        ref = before;
      } else {
        var refs = (doc.body || doc.getElementsByTagName("head")[0]).childNodes;
        ref = refs[refs.length - 1];
      }
      var sheets = doc.styleSheets;
      if (attributes) {
        for (var attributeName in attributes) {
          if (attributes.hasOwnProperty(attributeName)) {
            ss.setAttribute(attributeName, attributes[attributeName]);
          }
        }
      }
      ss.rel = "stylesheet";
      ss.href = href;
      ss.media = "only x";
      function ready(cb) {
        if (doc.body) {
          return cb();
        }
        setTimeout(function () {
          ready(cb);
        });
      }
      ready(function () {
        ref.parentNode.insertBefore(ss, before ? ref : ref.nextSibling);
      });
      var onloadcssdefined = function (cb) {
        var resolvedHref = ss.href;
        var i = sheets.length;
        while (i--) {
          if (sheets[i].href === resolvedHref) {
            return cb();
          }
        }
        setTimeout(function () {
          onloadcssdefined(cb);
        });
      };
      function loadCB() {
        if (ss.addEventListener) {
          ss.removeEventListener("load", loadCB);
        }
        ss.media = media || "all";
      }
      if (ss.addEventListener) {
        ss.addEventListener("load", loadCB);
      }
      ss.onloadcssdefined = onloadcssdefined;
      onloadcssdefined(loadCB);
      return ss;
    },

    js: (src, opt) => new Promise((resolve, reject) => {
      var script = document.createElement('script');
      if (src.startsWith('/')){
        src = ctx.root + src.substring(1);
      }
      script.src = src;
      if (opt) {
        for (let key of Object.keys(opt)) {
          script[key] = opt[key]
        }
      } else {
        // 默认异步，如果需要同步，第二个参数传入 {} 即可
        script.async = true
      }
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    }),

    jq: (fn) => {
      if (typeof jQuery === 'undefined') {
        utils.js(deps.jquery).then(fn)
      } else {
        fn()
      }
    },
    
    onLoading: (el) => {
      if (el) {
        $(el).append('<div class="loading-wrap"><svg xmlns="http://www.w3.org/2000/svg" width="2em" height="2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="2"><path stroke-dasharray="60" stroke-dashoffset="60" stroke-opacity=".3" d="M12 3C16.9706 3 21 7.02944 21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3Z"><animate fill="freeze" attributeName="stroke-dashoffset" dur="1.3s" values="60;0"/></path><path stroke-dasharray="15" stroke-dashoffset="15" d="M12 3C16.9706 3 21 7.02944 21 12"><animate fill="freeze" attributeName="stroke-dashoffset" dur="0.3s" values="15;0"/><animateTransform attributeName="transform" dur="1.5s" repeatCount="indefinite" type="rotate" values="0 12 12;360 12 12"/></path></g></svg></div>');
      }
    },
    onLoadSuccess: (el) => {
      if (el) {
        $(el).find('.loading-wrap').remove();
      }
    },
    onLoadFailure: (el) => {
      if (el) {
        $(el).find('.loading-wrap svg').remove();
        $(el).find('.loading-wrap').append('<svg xmlns="http://www.w3.org/2000/svg" width="2em" height="2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path stroke-dasharray="60" stroke-dashoffset="60" d="M12 3L21 20H3L12 3Z"><animate fill="freeze" attributeName="stroke-dashoffset" dur="0.5s" values="60;0"/></path><path stroke-dasharray="6" stroke-dashoffset="6" d="M12 10V14"><animate fill="freeze" attributeName="stroke-dashoffset" begin="0.6s" dur="0.2s" values="6;0"/></path></g><circle cx="12" cy="17" r="1" fill="currentColor" fill-opacity="0"><animate fill="freeze" attributeName="fill-opacity" begin="0.8s" dur="0.4s" values="0;1"/></circle></svg>');
        $(el).find('.loading-wrap').addClass('error');
      }
    },
    request: (el, url, callback, onFailure) => {
      let retryTimes = 3;
      utils.onLoading(el);
      function req() {
        return new Promise((resolve, reject) => {
          let status = 0; // 0 等待 1 完成 2 超时
          let timer = setTimeout(() => {
            if (status === 0) {
              status = 2;
              timer = null;
              reject('请求超时');
              if (retryTimes == 0) {
                onFailure();
              }
            }
          }, 5000);
          fetch(url).then(function(response) {
            if (status !== 2) {
              clearTimeout(timer);
              resolve(response);
              timer = null;
              status = 1;
            }
            if (response.ok) {
              return response.json();
            }
            throw new Error('Network response was not ok.');
          }).then(function(data) {
            retryTimes = 0;
            utils.onLoadSuccess(el);
            callback(data);
          }).catch(function(error) {
            if (retryTimes > 0) {
              retryTimes -= 1;
              setTimeout(() => {
                req();
              }, 5000);
            } else {
              utils.onLoadFailure(el);
              onFailure();
            }
          });
        });
      }
      req();
    },
  };
</script>

<script>
  const sidebar = {
    leftbar: () => {
      if (l_body) {
        l_body.toggleAttribute('leftbar');
        l_body.removeAttribute('rightbar');
      }
    },
    rightbar: () => {
      if (l_body) {
        l_body.toggleAttribute('rightbar');
        l_body.removeAttribute('leftbar');
      }
    },
    dismiss: () => {
      if (l_body) {
        l_body.removeAttribute('leftbar');
        l_body.removeAttribute('rightbar');
      }
    },
    toggleTOC: () => {
      document.querySelector('#data-toc').classList.toggle('collapse');
    }
  }
</script>
<script type="text/javascript">
  (() => {
    const tagSwitchers = document.querySelectorAll('.tag-subtree.parent-tag > a > .tag-switcher-wrapper')
    for (const tagSwitcher of tagSwitchers) {
      tagSwitcher.addEventListener('click', (e) => {
        const parent = e.target.closest('.tag-subtree.parent-tag')
        parent.classList.toggle('expanded')
        e.preventDefault()
      })
    }

    // Get active tag from query string, then activate it.
    const urlParams = new URLSearchParams(window.location.search)
    const activeTag = urlParams.get('tag')
    if (activeTag) {
      let tag = document.querySelector(`.tag-subtree[data-tag="${activeTag}"]`)
      if (tag) {
        tag.querySelector('a').classList.add('active')
        
        while (tag) {
          tag.classList.add('expanded')
          tag = tag.parentElement.closest('.tag-subtree.parent-tag')
        }
      }
    }
  })()
</script>


<!-- required -->
<script src="/js/main.js?v=1.29.1" defer></script>

<script type="text/javascript">
  const applyTheme = (theme) => {
    if (theme === 'auto') {
      document.documentElement.removeAttribute('data-theme')
    } else {
      document.documentElement.setAttribute('data-theme', theme)
    }

    applyThemeToGiscus(theme)
  }

  const applyThemeToGiscus = (theme) => {
    theme = theme === 'auto' ? 'preferred_color_scheme' : theme

    const cmt = document.getElementById('giscus')
    if (cmt) {
      // This works before giscus load.
      cmt.setAttribute('data-theme', theme)
    }

    const iframe = document.querySelector('#comments > section.giscus > iframe')
    if (iframe) {
      // This works after giscus loaded.
      const src = iframe.src
      const newSrc = src.replace(/theme=[\w]+/, `theme=${theme}`)
      iframe.src = newSrc
    }
  }

  const switchTheme = () => {
    // light -> dark -> auto -> light -> ...
    const currentTheme = document.documentElement.getAttribute('data-theme')
    let newTheme;
    switch (currentTheme) {
      case 'light':
        newTheme = 'dark'
        break
      case 'dark':
        newTheme = 'auto'
        break
      default:
        newTheme = 'light'
    }
    applyTheme(newTheme)
    window.localStorage.setItem('Stellar.theme', newTheme)

    const messages = {
      light: `切换到浅色模式`,
      dark: `切换到深色模式`,
      auto: `切换到跟随系统配色`,
    }
    hud?.toast?.(messages[newTheme])
  }

  (() => {
    // Apply user's preferred theme, if any.
    const theme = window.localStorage.getItem('Stellar.theme')
    if (theme !== null) {
      applyTheme(theme)
    }
  })()
</script>


<!-- optional -->



<script defer>
  window.addEventListener('DOMContentLoaded', (event) => {
    ctx.services = Object.assign({}, JSON.parse(`{"mdrender":{"js":"/js/services/mdrender.js"},"siteinfo":{"js":"/js/services/siteinfo.js","api":null},"ghinfo":{"js":"/js/services/ghinfo.js"},"sites":{"js":"/js/services/sites.js"},"friends":{"js":"/js/services/friends.js"},"timeline":{"js":"/js/services/timeline.js"},"fcircle":{"js":"/js/services/fcircle.js"},"weibo":{"js":"/js/services/weibo.js"},"memos":{"js":"/js/services/memos.js"}}`));
    for (let id of Object.keys(ctx.services)) {
      const js = ctx.services[id].js;
      if (id == 'siteinfo') {
        ctx.cardlinks = document.querySelectorAll('a.link-card[cardlink]');
        if (ctx.cardlinks?.length > 0) {
          utils.js(js, { defer: true }).then(function () {
            setCardLink(ctx.cardlinks);
          });
        }
      } else {
        const els = document.getElementsByClassName(`ds-${id}`);
        if (els?.length > 0) {
          utils.jq(() => {
            if (id == 'timeline' || 'memos' || 'marked') {
              utils.js(deps.marked).then(function () {
                utils.js(js, { defer: true });
              });
            } else {
              utils.js(js, { defer: true });
            }
          });
        }
      }
    }
  });
</script>

<script>
  window.addEventListener('DOMContentLoaded', (event) => {
    ctx.search = {
      path: `/search.json`,
    }
    utils.js('/js/search/local-search.js', { defer: true });
  });
</script><script>
  window.FPConfig = {
    delay: 0,
    ignoreKeywords: [],
    maxRPS: 5,
    hoverDelay: 25
  };
</script>
<script defer src="https://cdn.jsdelivr.net/npm/flying-pages@2/flying-pages.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@19.1.3/dist/lazyload.min.js"></script>
<script>
  // https://www.npmjs.com/package/vanilla-lazyload
  // Set the options globally
  // to make LazyLoad self-initialize
  window.lazyLoadOptions = {
    elements_selector: ".lazy",
  };
  // Listen to the initialization event
  // and get the instance of LazyLoad
  window.addEventListener(
    "LazyLoad::Initialized",
    function (event) {
      window.lazyLoadInstance = event.detail.instance;
    },
    false
  );
  document.addEventListener('DOMContentLoaded', function () {
    window.lazyLoadInstance?.update();
  });
</script><script>
  ctx.fancybox = {
    selector: `.timenode p>img`,
    css: `https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0/dist/fancybox/fancybox.css`,
    js: `https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0/dist/fancybox/fancybox.umd.js`
  };
  var selector = '[data-fancybox]:not(.error)';
  if (ctx.fancybox.selector) {
    selector += `, ${ctx.fancybox.selector}`
  }
  var needFancybox = document.querySelectorAll(selector).length !== 0;
  if (!needFancybox) {
    const els = document.getElementsByClassName('ds-memos');
    if (els != undefined && els.length > 0) {
      needFancybox = true;
    }
  }
  if (needFancybox) {
    utils.css(ctx.fancybox.css);
    utils.js(ctx.fancybox.js, { defer: true }).then(function () {
      Fancybox.bind(selector, {
        hideScrollbar: false,
        Thumbs: {
          autoStart: false,
        },
        caption: (fancybox, slide) => {
          return slide.triggerEl.alt || slide.triggerEl.dataset.caption || null
        }
      });
    })
  }
</script>
<script>
  window.addEventListener('DOMContentLoaded', (event) => {
    const swiper_api = document.getElementById('swiper-api');
    if (swiper_api != undefined) {
      utils.css(`https://unpkg.com/swiper@10.3.1/swiper-bundle.min.css`);
      utils.js(`https://unpkg.com/swiper@10.3.1/swiper-bundle.min.js`, { defer: true }).then(function () {
        const effect = swiper_api.getAttribute('effect') || '';
        var swiper = new Swiper('.swiper#swiper-api', {
          slidesPerView: 'auto',
          spaceBetween: 8,
          centeredSlides: true,
          effect: effect,
          rewind: true,
          pagination: {
            el: '.swiper-pagination',
            clickable: true,
          },
          navigation: {
            nextEl: '.swiper-button-next',
            prevEl: '.swiper-button-prev',
          },
        });
      })
    }
  });
</script>
<script>
  document.addEventListener('DOMContentLoaded', function () {
    window.codeElements = document.querySelectorAll('.code');
    if (window.codeElements.length > 0) {
      ctx.copycode = {
        default_text: `Copy`,
        success_text: `Copied`,
        toast: `复制成功`,
      };
      utils.js('/js/plugins/copycode.js');
    }
  });
</script>


<!-- inject -->

</div></body></html>
